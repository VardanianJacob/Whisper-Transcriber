# ðŸ§  Whisper Transcriber â€“ FastAPI Server Guide

This guide explains how to launch the FastAPI server for audio transcription using the Whisper API.

---

## ðŸ“ Project Structure

Make sure your project structure looks like this:

WhisperAPI/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ whisper.py
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ save.py
â”‚   â””â”€â”€ telegram_auth.py
â”œâ”€â”€ mini_app/
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ transcripts/
â”œâ”€â”€ config.py
â”œâ”€â”€ server.py            â† main FastAPI entry point
â”œâ”€â”€ main.py              â† CLI tool entry point
â”œâ”€â”€ .env                 â† local environment config
â”œâ”€â”€ env.template         â† example config file
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ fly.toml
â””â”€â”€ fastapi_run_instructions.txt

---

## âš™ï¸ Setup Instructions

### 1. Navigate to project directory

```bash
cd /path/to/WhisperAPI
```

---

### 2. Create `.env` from template

```bash
cp env.template .env
```

Then open `.env` and add your keys:

```env
WHISPER_API_KEY=your_lemonfox_key
INTERNAL_API_KEY=your_internal_key
ENV=dev  # use "prod" for production (hides Swagger docs)
```

---

### 3. Activate virtual environment

```bash
source venv/bin/activate
```

(If not created yet: `python3 -m venv venv`)

---

### 4. Install dependencies

```bash
pip install -r requirements.txt
```

---

### 5. Run FastAPI server

```bash
uvicorn server:app --reload
```

---

### 6. Access in browser

* Upload UI: [http://127.0.0.1:8000](http://127.0.0.1:8000)
* Swagger Docs (if `ENV=dev`): [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
* ReDoc (if `ENV=dev`): [http://127.0.0.1:8000/redoc](http://127.0.0.1:8000/redoc)

---

## ðŸ” API Protection

When `ENV=prod`, API access requires:

```http
x-api-key: your_internal_key
```

Without it, requests return `403 Forbidden`.

---

## ðŸ“‚ Output

Transcriptions are saved into the `transcripts/` folder as:

- `.md` and `.html` (if `output_format=markdown`)
- `.txt`, `.srt`, or `.json` depending on response format

---

## â›” Stop the server

Use `Ctrl + C` in the terminal.

---

## ðŸ’¡ Tips

- `.env` is excluded from Git.
- Swagger UI is auto-disabled in production.
- Large files (>100MB) will be rejected by the API.
